<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>MaBatis入门二</title>
    <link href="/2020/08/27/mybatis%E5%85%A5%E9%97%A8%E4%BA%8C/"/>
    <url>/2020/08/27/mybatis%E5%85%A5%E9%97%A8%E4%BA%8C/</url>
    
    <content type="html"><![CDATA[<p>MyBatis进行 CRUD 操作，对结果进行封装。</p><a id="more"></a><h1 id="1-使用MyBatis进行CRUD操作"><a href="#1-使用MyBatis进行CRUD操作" class="headerlink" title="1 使用MyBatis进行CRUD操作"></a>1 使用MyBatis进行CRUD操作</h1><h2 id="1-1-根据ID查询user"><a href="#1-1-根据ID查询user" class="headerlink" title="1.1 根据ID查询user"></a>1.1 根据ID查询user</h2><h3 id="1-1-1-持久层接口添加findById方法"><a href="#1-1-1-持久层接口添加findById方法" class="headerlink" title="1.1.1  持久层接口添加findById方法"></a>1.1.1  持久层接口添加findById方法</h3><pre><code class="hljs java"><span class="hljs-function">User <span class="hljs-title">findById</span><span class="hljs-params">(Integer userId)</span></span>;</code></pre><h3 id="1-1-2-在IUserDao-xml映射配置文件中配置"><a href="#1-1-2-在IUserDao-xml映射配置文件中配置" class="headerlink" title="1.1.2 在IUserDao.xml映射配置文件中配置"></a>1.1.2 在IUserDao.xml映射配置文件中配置</h3><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"findById"</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">"cn.pine.domain.User"</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">"int"</span>&gt;</span>SELECT * FROM USER WHERE id = #&#123;uid&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span></code></pre><p>resultType：是指定结果集的类型</p><p>parameterType：用于指定传入参数的类型</p><p>#{}：代表占位符，作用相当于声明形参</p><h3 id="1-1-3-测试"><a href="#1-1-3-测试" class="headerlink" title="1.1.3 测试"></a>1.1.3 测试</h3><p>抽取测试类重复代码</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MybatisTest</span> </span>&#123;    <span class="hljs-keyword">private</span> InputStream in;    <span class="hljs-keyword">private</span> SqlSessionFactory factory;    <span class="hljs-keyword">private</span> SqlSession session;    <span class="hljs-keyword">private</span> IUserDao userDao;    <span class="hljs-meta">@Before</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception</span>&#123;        in = Resources.getResourceAsStream(<span class="hljs-string">"SqlMapConfig.xml"</span>);        SqlSessionFactoryBuilder builder = <span class="hljs-keyword">new</span> SqlSessionFactoryBuilder();        factory = builder.build(in);        session = factory.openSession();        userDao = session.getMapper(IUserDao.class);    &#125;    <span class="hljs-meta">@After</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">destroy</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception</span>&#123;        session.commit();        session.close();        in.close();    &#125;    <span class="hljs-meta">@Test</span>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testFindByID</span><span class="hljs-params">()</span></span>&#123;        User user = userDao.findById(<span class="hljs-number">41</span>);        System.out.println(user);    &#125;</code></pre><p>通过Junit 的Before与After注解来抽取重复的测试代码，分别在运行Test开始和结束之后运行，简化代码。</p><p>测试结果：</p><pre><code class="hljs undefined">2020-08-24 15:09:50,898 396    [           main] <span class="hljs-builtin-name">DEBUG</span>  cn.pine.dao.IUserDao.findById  - ==&gt;  Preparing: SELECT * <span class="hljs-keyword">FROM</span><span class="hljs-built_in"> USER </span>WHERE id = ? 2020-08-24 15:09:50,916 414    [           main] <span class="hljs-builtin-name">DEBUG</span>  cn.pine.dao.IUserDao.findById  - ==&gt; Parameters: 41(Integer)2020-08-24 15:09:50,943 441    [           main] <span class="hljs-builtin-name">DEBUG</span>  cn.pine.dao.IUserDao.findById  - &lt;==      Total: 1User&#123;<span class="hljs-attribute">id</span>=41, <span class="hljs-attribute">username</span>=<span class="hljs-string">'甲'</span>, <span class="hljs-attribute">birthday</span>=Tue Feb 27 17:47:08 CST 2018, <span class="hljs-attribute">sex</span>=<span class="hljs-string">'男'</span>, <span class="hljs-attribute">address</span>=<span class="hljs-string">'北京'</span>&#125;</code></pre><hr><h2 id="1-2-保存操作"><a href="#1-2-保存操作" class="headerlink" title="1.2 保存操作"></a>1.2 保存操作</h2><h3 id="1-2-1-持久层接口中添加saveUser方法"><a href="#1-2-1-持久层接口中添加saveUser方法" class="headerlink" title="1.2.1 持久层接口中添加saveUser方法"></a>1.2.1 持久层接口中添加saveUser方法</h3><pre><code class="hljs java"><span class="hljs-comment">//返回数据库中影响行数</span><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">saveUser</span><span class="hljs-params">(User user)</span></span>;</code></pre><h3 id="1-2-2-映射配置"><a href="#1-2-2-映射配置" class="headerlink" title="1.2.2 映射配置"></a>1.2.2 映射配置</h3><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">insert</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"saveUser"</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">"cn.pine.domain.User"</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">selectKey</span> <span class="hljs-attr">keyColumn</span>=<span class="hljs-string">"id"</span> <span class="hljs-attr">keyProperty</span>=<span class="hljs-string">"id"</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">"int"</span>&gt;</span>      SELECT last_insert_id();  <span class="hljs-tag">&lt;/<span class="hljs-name">selectKey</span>&gt;</span>    INSERT INTO USER (username,birthday,sex,address) VALUES (#&#123;username&#125;,#&#123;birthday&#125;,#&#123;sex&#125;,#&#123;address&#125;)<span class="hljs-tag">&lt;/<span class="hljs-name">insert</span>&gt;</span></code></pre><p>parameterType：传入的参数为对象，填写全限定类名或别名</p><p>#{}中填写的是对象的属性，如user.username，但是由于在parameterType已经指定实体类，可以直接填写username。</p><p>selectKey标签中获取保存时的id值，并传给参数中的对象。</p><h3 id="1-2-3-测试"><a href="#1-2-3-测试" class="headerlink" title="1.2.3 测试"></a>1.2.3 测试</h3><pre><code class="hljs java">@Testpublic void testSaveUser()&#123;User user = new User();user.setUsername("saveUser");user.setAddress("西安");user.setSex("男");user.setBirthday(new Date());System.out.println("beforeSaving:" + user);userDao.saveUser(user);System.out.println("afterSaving:+user);&#125;</code></pre><p>测试结果</p><pre><code class="hljs undefined">beforeSaving:User&#123;<span class="hljs-attribute">id</span>=<span class="hljs-literal">null</span>, <span class="hljs-attribute">username</span>=<span class="hljs-string">'saveUser'</span>, <span class="hljs-attribute">birthday</span>=Mon Aug 24 15:25:51 CST 2020, <span class="hljs-attribute">sex</span>=<span class="hljs-string">'男'</span>, <span class="hljs-attribute">address</span>=<span class="hljs-string">'西安'</span>&#125;afterSavingUser:&#123;<span class="hljs-attribute">id</span>=50, <span class="hljs-attribute">username</span>=<span class="hljs-string">'saveUser'</span>, <span class="hljs-attribute">birthday</span>=Mon Aug 24 15:25:51 CST 2020, <span class="hljs-attribute">sex</span>=<span class="hljs-string">'男'</span>, <span class="hljs-attribute">address</span>=<span class="hljs-string">'西安'</span>&#125;</code></pre><hr><h2 id="1-3-更新操作"><a href="#1-3-更新操作" class="headerlink" title="1.3 更新操作"></a>1.3 更新操作</h2><h3 id="1-3-1-持久层接口添加updateUser方法"><a href="#1-3-1-持久层接口添加updateUser方法" class="headerlink" title="1.3.1 持久层接口添加updateUser方法"></a>1.3.1 持久层接口添加updateUser方法</h3><pre><code class="hljs java"><span class="hljs-comment">//返回影响记录行数</span><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">updateUser</span><span class="hljs-params">(User user)</span></span>;</code></pre><h3 id="1-3-2-映射配置"><a href="#1-3-2-映射配置" class="headerlink" title="1.3.2 映射配置"></a>1.3.2 映射配置</h3><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">update</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"updateUser"</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">"cn.pine.domain.User"</span>&gt;</span>        UPDATE USER SET username=#&#123;username&#125;,birthday=#&#123;birthday&#125;,sex=#&#123;sex&#125;,address=#&#123;address&#125;WHERE id=#&#123;id&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">update</span>&gt;</span></code></pre><h3 id="1-3-3-测试"><a href="#1-3-3-测试" class="headerlink" title="1.3.3 测试"></a>1.3.3 测试</h3><pre><code class="hljs java"><span class="hljs-meta">@Test</span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testUpdateUser</span><span class="hljs-params">()</span> </span>&#123;User user = userDao.findById(<span class="hljs-number">48</span>);user.setAddress(<span class="hljs-string">"成都"</span>);<span class="hljs-keyword">int</span> res = userDao.updateUser(user);System.out.println(res);&#125;</code></pre><p>输出1，表示更新成功。</p><hr><h2 id="1-4-删除操作"><a href="#1-4-删除操作" class="headerlink" title="1.4 删除操作"></a>1.4 删除操作</h2><h3 id="1-4-1-持久层接口中添加deleteUser方法"><a href="#1-4-1-持久层接口中添加deleteUser方法" class="headerlink" title="1.4.1 持久层接口中添加deleteUser方法"></a>1.4.1 持久层接口中添加deleteUser方法</h3><pre><code class="hljs java"><span class="hljs-comment">//返回影响条数</span><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">deleteUser</span><span class="hljs-params">(Integer userId)</span></span>;</code></pre><h3 id="1-4-2-映射配置"><a href="#1-4-2-映射配置" class="headerlink" title="1.4.2 映射配置"></a>1.4.2 映射配置</h3><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">delete</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"deleteUser"</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">"java.lang.Integer"</span>&gt;</span>        DELETE FROM USER WHERE id=#&#123;uid&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">delete</span>&gt;</span></code></pre><h3 id="1-4-3-测试"><a href="#1-4-3-测试" class="headerlink" title="1.4.3 测试"></a>1.4.3 测试</h3><pre><code class="hljs java"><span class="hljs-meta">@Test</span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testDeleteUser</span><span class="hljs-params">()</span> </span>&#123;<span class="hljs-keyword">int</span> res = userDao.deleteUser(<span class="hljs-number">50</span>);System.out.println(res);&#125;</code></pre><p>输出1，执行成功。</p><hr><h2 id="1-5-用户模糊查询"><a href="#1-5-用户模糊查询" class="headerlink" title="1.5 用户模糊查询"></a>1.5 用户模糊查询</h2><h3 id="1-5-1-持久层接口中添加findByName方法"><a href="#1-5-1-持久层接口中添加findByName方法" class="headerlink" title="1.5.1 持久层接口中添加findByName方法"></a>1.5.1 持久层接口中添加findByName方法</h3><pre><code class="hljs java"><span class="hljs-function">List&lt;User&gt; <span class="hljs-title">findByName</span><span class="hljs-params">(String username)</span></span>;</code></pre><h3 id="1-5-2-映射配置"><a href="#1-5-2-映射配置" class="headerlink" title="1.5.2 映射配置"></a>1.5.2 映射配置</h3><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"findByName"</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">"cn.pine.domain.User"</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">"String"</span>&gt;</span>    SELECT * FROM USER WHERE username like #&#123;username&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span></code></pre><h3 id="1-5-3-测试"><a href="#1-5-3-测试" class="headerlink" title="1.5.3 测试"></a>1.5.3 测试</h3><pre><code class="hljs java"><span class="hljs-meta">@Test</span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testFindByName</span><span class="hljs-params">()</span> </span>&#123;    List&lt;User&gt; users = userDao.findByName(<span class="hljs-string">"%甲%"</span>);    <span class="hljs-keyword">for</span> (User user : users) &#123;        System.out.println(user);    &#125;&#125;</code></pre><p>返回结果</p><pre><code class="hljs undefined">User&#123;<span class="hljs-attribute">id</span>=41, <span class="hljs-attribute">username</span>=<span class="hljs-string">'甲'</span>, <span class="hljs-attribute">birthday</span>=Tue Feb 27 17:47:08 CST 2018, <span class="hljs-attribute">sex</span>=<span class="hljs-string">'男'</span>, <span class="hljs-attribute">address</span>=<span class="hljs-string">'北京'</span>&#125;</code></pre><hr><h2 id="1-6-查询使用聚合函数"><a href="#1-6-查询使用聚合函数" class="headerlink" title="1.6 查询使用聚合函数"></a>1.6 查询使用聚合函数</h2><h3 id="1-6-1-持久层接口添加方法"><a href="#1-6-1-持久层接口添加方法" class="headerlink" title="1.6.1 持久层接口添加方法"></a>1.6.1 持久层接口添加方法</h3><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">findTotal</span><span class="hljs-params">()</span></span>;</code></pre><h3 id="1-6-2-映射配置"><a href="#1-6-2-映射配置" class="headerlink" title="1.6.2 映射配置"></a>1.6.2 映射配置</h3><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"findTotal"</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">"int"</span>&gt;</span>SELECT COUNT(*) FROM USER<span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span></code></pre><h3 id="1-6-3-测试"><a href="#1-6-3-测试" class="headerlink" title="1.6.3 测试"></a>1.6.3 测试</h3><pre><code class="hljs java"><span class="hljs-meta">@Test</span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testFindTotal</span><span class="hljs-params">()</span> </span>&#123;    <span class="hljs-keyword">int</span> total = userDao.findTotal();    System.out.println(total);&#125;</code></pre><p>返回6，为数据库中总条数。</p><hr><h1 id="2-包装对象传递输入参数"><a href="#2-包装对象传递输入参数" class="headerlink" title="2 包装对象传递输入参数"></a>2 包装对象传递输入参数</h1><h2 id="2-1-QueryVo包装类"><a href="#2-1-QueryVo包装类" class="headerlink" title="2.1  QueryVo包装类"></a>2.1  QueryVo包装类</h2><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">QueryVo</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Serializable</span> </span>&#123;    <span class="hljs-keyword">private</span> User user;    <span class="hljs-function"><span class="hljs-keyword">public</span> User <span class="hljs-title">getUser</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> user;    &#125;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setUser</span><span class="hljs-params">(User user)</span> </span>&#123;        <span class="hljs-keyword">this</span>.user = user;    &#125;&#125;</code></pre><h2 id="2-2-持久层接口添加findByVo方法"><a href="#2-2-持久层接口添加findByVo方法" class="headerlink" title="2.2 持久层接口添加findByVo方法"></a>2.2 持久层接口添加findByVo方法</h2><pre><code class="hljs java"><span class="hljs-function">List&lt;User&gt; <span class="hljs-title">findByVo</span><span class="hljs-params">(QueryVo vo)</span></span>;</code></pre><h2 id="2-3-映射配置"><a href="#2-3-映射配置" class="headerlink" title="2.3 映射配置"></a>2.3 映射配置</h2><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"findByVo"</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">"cn.pine.domain.User"</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">"cn.pine.domain.QueryVo"</span>&gt;</span>    SELECT * FROM USER WHERE username LIKE #&#123;user.username&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span></code></pre><h2 id="2-4-测试"><a href="#2-4-测试" class="headerlink" title="2.4 测试"></a>2.4 测试</h2><p>包装类作参数</p><pre><code class="hljs java"><span class="hljs-meta">@Test</span><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testFindByVo</span><span class="hljs-params">()</span></span>&#123;    QueryVo queryVo = <span class="hljs-keyword">new</span> QueryVo();    User user = <span class="hljs-keyword">new</span> User();    user.setUsername(<span class="hljs-string">"%甲%"</span>);    queryVo.setUser(user);    List&lt;User&gt; users = userDao.findByVo(queryVo);    <span class="hljs-keyword">for</span> (User u : users) &#123;        System.out.println(u);    &#125;&#125;</code></pre><p>返回结果</p><pre><code class="hljs undefined">User&#123;<span class="hljs-attribute">id</span>=41, <span class="hljs-attribute">username</span>=<span class="hljs-string">'甲'</span>, <span class="hljs-attribute">birthday</span>=Tue Feb 27 17:47:08 CST 2018, <span class="hljs-attribute">sex</span>=<span class="hljs-string">'男'</span>, <span class="hljs-attribute">address</span>=<span class="hljs-string">'北京'</span>&#125;</code></pre><h1 id="3-输出结果封装"><a href="#3-输出结果封装" class="headerlink" title="3 输出结果封装"></a>3 输出结果封装</h1><p>​    当实体类属性与数据库表中的列名不一致时，对输出结果封装可以有两种方法。</p><ol><li>​    修改映射配置中的SQL语句，例如将原来的列明起与实体类属性一致的别名<strong>select columnName from tableName</strong> 换为 <strong>select columnName as propetyName from tableName</strong> </li><li>在接口配置文件映射配置中使用resultMap</li></ol><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"className"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"xxxMap"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">column</span>=<span class="hljs-string">"primary_column"</span> <span class="hljs-attr">property</span>=<span class="hljs-string">"propertyA"</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">"columnB"</span> <span class="hljs-attr">property</span>=<span class="hljs-string">"propertyB"</span>/&gt;</span>...<span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">"columnG"</span> <span class="hljs-attr">property</span>=<span class="hljs-string">"propertyG"</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">'funcName'</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">"xxxMap"</span>&gt;</span>select * from tableName<span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span></code></pre><hr><h1 id="4-SqlMapConfig-xml配置内容"><a href="#4-SqlMapConfig-xml配置内容" class="headerlink" title="4 SqlMapConfig.xml配置内容"></a>4 SqlMapConfig.xml配置内容</h1><h2 id="4-1-配置内容与顺序"><a href="#4-1-配置内容与顺序" class="headerlink" title="4.1 配置内容与顺序"></a>4.1 配置内容与顺序</h2><pre><code class="hljs undefined">-<span class="ruby">properties（属性）</span>-<span class="ruby">-property</span>-<span class="ruby">settings（全局配置参数）</span>-<span class="ruby">-setting</span>-<span class="ruby">typeAliases（类型别名）</span>-<span class="ruby">-typeAliase</span>-<span class="ruby">-package</span>-<span class="ruby">typeHandlers（类型处理器）</span>-<span class="ruby">objectFactory（对象工厂）</span>-<span class="ruby">plugins（插件）</span>-<span class="ruby">environments（环境集合属性对象）</span>-<span class="ruby">-environment（环境子属性对象）</span>-<span class="ruby">--transactionManager（事务管理）</span>-<span class="ruby">--dataSource（数据源）</span>-<span class="ruby">mappers（映射器）</span>-<span class="ruby">-mapper</span>-<span class="ruby">-package</span></code></pre><h2 id="4-2-properties"><a href="#4-2-properties" class="headerlink" title="4.2 properties"></a>4.2 properties</h2><p>有两种方式进行配置</p><ol><li><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"jdbc.driver"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"com.mysql.jdbc.Driver"</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"jdbc.url"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"jdbc:mysql://localhost:3306/mybatis"</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"jdbc.username"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"root"</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"jdbc.password"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"root"</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span></code></pre></li></ol><ol start="2"><li>先在类路径下创建jdbcConfig.properties文件</li></ol><pre><code class="hljs undefined"><span class="hljs-attr">jdbc.driver</span>=com.mysql.jdbc.Driver<span class="hljs-attr">jdbc.url</span>=jdbc:mysql://localhost:<span class="hljs-number">3306</span>/mybatis<span class="hljs-attr">jdbc.username</span>=root<span class="hljs-attr">jdbc.password</span>=root</code></pre><p>​     再配置propety标签</p><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">properties</span> <span class="hljs-attr">url</span>=<span class="hljs-string">"file:///绝对路径/jdbcConfig.properties"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span></code></pre><p>​    经过以上properties的配置后，dataSource标签就可以引用以上配置</p><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dataSource</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"POOLED"</span>&gt;</span>     <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"driver"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"$&#123;jdbc.driver&#125;"</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"url"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"$&#123;jdbc.url&#125;"</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"username"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"$&#123;jdbc.username&#125;"</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"password"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"$&#123;jdbc.password&#125;"</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">dataSource</span>&gt;</span></code></pre><h2 id="4-3-typeAliases（类型别名）"><a href="#4-3-typeAliases（类型别名）" class="headerlink" title="4.3 typeAliases（类型别名）"></a>4.3 typeAliases（类型别名）</h2><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">typeAliases</span>&gt;</span>    <span class="hljs-comment">&lt;!-- 单个别名定义 --&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">typeAlias</span> <span class="hljs-attr">alias</span>=<span class="hljs-string">"别名"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"全限定类名"</span>/&gt;</span><span class="hljs-comment">&lt;!-- 批量别名定义，扫描整个包下的类，别名为类名（首字母大写或小写都可以） --&gt;</span>     <span class="hljs-tag">&lt;<span class="hljs-name">package</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"com.pine.domain"</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">package</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"其它包"</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">typeAliases</span>&gt;</span></code></pre><h2 id="4-4-mappers（映射器）"><a href="#4-4-mappers（映射器）" class="headerlink" title="4.4 mappers（映射器）"></a>4.4 mappers（映射器）</h2><pre><code class="hljs undefined">1.使用相对于类路径的资源如：&lt;mapper <span class="hljs-attribute">resource</span>=<span class="hljs-string">"com/pine/dao/IUserDao.xml"</span> /&gt;2.使用 mapper 接口类路径如：&lt;mapper <span class="hljs-attribute">class</span>=<span class="hljs-string">"com.pine.dao.UserDao"</span>/&gt;注意：此种方法要求 mapper 接口名称和 mapper 映射文件名称相同，且放在同一个目录中。3.注册指定包下的所有 mapper 接口如：&lt;package <span class="hljs-attribute">name</span>=<span class="hljs-string">"cn.pine.mybatis.mapper"</span>/&gt;注意：此种方法要求 mapper 接口名称和 mapper 映射文件名称相同，且放在同一个目录中。</code></pre>]]></content>
    
    
    <categories>
      
      <category>框架</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>MyBatis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MyBatis入门一</title>
    <link href="/2020/08/26/maybatis%E5%85%A5%E9%97%A8%E4%B8%80/"/>
    <url>/2020/08/26/maybatis%E5%85%A5%E9%97%A8%E4%B8%80/</url>
    
    <content type="html"><![CDATA[<p>MyBatis入门，接口层映射配置，SqlMapConfig配置。</p><a id="more"></a><h1 id="MyBatis简要了解"><a href="#MyBatis简要了解" class="headerlink" title="MyBatis简要了解"></a>MyBatis简要了解</h1><blockquote><p>MyBatis 本是<a href="https://baike.baidu.com/item/apache/6265" target="_blank" rel="noopener">apache</a>的一个开源项目<a href="https://baike.baidu.com/item/iBatis" target="_blank" rel="noopener">iBatis</a>, 2010年这个项目由apache software foundation 迁移到了google code，并且改名为MyBatis 。2013年11月迁移到Github。</p><p>iBATIS一词来源于“internet”和“abatis”的组合，是一个基于Java的<a href="https://baike.baidu.com/item/持久层/3584971" target="_blank" rel="noopener">持久层</a>框架。iBATIS提供的持久层框架包括SQL Maps和Data Access Objects（DAOs）</p></blockquote><ul><li>MyBatis是一个 基于Java的持久层框架，它内部封装Jdbc，使开发者只需要关注SQL语句本身，不需关注处理加载驱动、创建连接、创建statement等过程。其通过XML或注解的方式配置所需的statement，通过Java对象和statement中的SQL的动态参数进行映射生成最终的SQL语句，最后由MyBatis框架执行SQL语句并将结果映射为Java对象并返回。</li></ul><h1 id="MyBatis框架快速入门"><a href="#MyBatis框架快速入门" class="headerlink" title="MyBatis框架快速入门"></a>MyBatis框架快速入门</h1><h2 id="下载-MyBatis-框架"><a href="#下载-MyBatis-框架" class="headerlink" title="下载 MyBatis 框架"></a>下载 MyBatis 框架</h2><p>下载地址：地址：<a href="https://github.com/mybatis/mybatis-3（本次使用的是3.4.5版本）" target="_blank" rel="noopener">https://github.com/mybatis/mybatis-3（本次使用的是3.4.5版本）</a></p><h2 id="Maven-导入坐标"><a href="#Maven-导入坐标" class="headerlink" title="Maven 导入坐标"></a>Maven 导入坐标</h2><p>在pom.xml文件中导入坐标（同时要导入mysql-jdbc-java坐标）</p><pre><code class="hljs XML"> <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.4.5<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span> <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.10<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span> <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.1.6<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>runtime<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span> <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>log4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>log4j<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.2.12<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span> <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span></code></pre><h2 id="工程目录结构"><a href="#工程目录结构" class="headerlink" title="工程目录结构"></a>工程目录结构</h2><p><img src="https://img-blog.csdnimg.cn/20200824103211890.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3BpbmVfZTM=,size_16,color_FFFFFF,t_70" srcset="/img/loading.gif" alt="img"></p><h2 id="User表结构"><a href="#User表结构" class="headerlink" title="User表结构"></a>User表结构</h2><p><img src="https://img-blog.csdnimg.cn/20200824145319447.png" srcset="/img/loading.gif" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" srcset="/img/loading.gif" alt="点击并拖拽以移动"></p><h2 id="实体类User"><a href="#实体类User" class="headerlink" title="实体类User"></a>实体类User</h2><p>实现<strong>Serializable</strong>接口，成员变量声明使用包装类。这里省略了getter，setter方法还有toString方法。</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Serializable</span> </span>&#123;    <span class="hljs-keyword">private</span> Integer id;    <span class="hljs-keyword">private</span> String username;    <span class="hljs-keyword">private</span> Date birthday;    <span class="hljs-keyword">private</span> String sex;    <span class="hljs-keyword">private</span> String address;    <span class="hljs-keyword">private</span> List&lt;Account&gt; accounts;    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Account&gt; <span class="hljs-title">getAccounts</span><span class="hljs-params">()</span> </span>&#123;        <span class="hljs-keyword">return</span> accounts;    &#125;</code></pre><h2 id="持久层IUserDao"><a href="#持久层IUserDao" class="headerlink" title="持久层IUserDao"></a>持久层IUserDao</h2><p>放在src. main.java.cn.pine.dao下，声明操作数据库的方法</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">IUserDao</span> </span>&#123;    <span class="hljs-function">List&lt;User&gt; <span class="hljs-title">findAll</span><span class="hljs-params">()</span></span>;｝</code></pre><h2 id="持久层接口的映射IUserDao-xml"><a href="#持久层接口的映射IUserDao-xml" class="headerlink" title="持久层接口的映射IUserDao.xml"></a>持久层接口的映射IUserDao.xml</h2><p>创建位置：必须和持久层接口在相同的包中。这里放在src.main.resources.cn.pine.dao下</p><p>名称：必须以持久层接口名称命名文件名，扩展名是.xml </p><pre><code class="hljs XML"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><span class="hljs-meta">&lt;!DOCTYPE mapper        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"        "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">"cn.pine.dao.IUserDao"</span>&gt;</span><span class="hljs-comment">&lt;!-- 配置查询所有操作 --&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"findAll"</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">"cn.pine.domain.User"</span>&gt;</span>            select * from user  <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span></code></pre><p>SqlMapConfig.xml配置文件</p><p>SqlMapConfig.xml是MyBatis的全局配置文件，可以配置数据源，事务和映射文件等等信息。SqlMapConfig.xml配置文件放在resource目录下。</p><pre><code class="hljs XML"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><span class="hljs-meta">&lt;!DOCTYPE configuration        PUBLIC "-//mybatis.org//DTD Config 3.0//EN"        "http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span>    <span class="hljs-comment">&lt;!-- 配置类别名 --&gt;</span>     <span class="hljs-tag">&lt;<span class="hljs-name">typeAliases</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">typeAlias</span> <span class="hljs-attr">alias</span>=<span class="hljs-string">"user"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"cn.pine.domain.User"</span>/&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">package</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"cn.pine.domain.User"</span>/&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">typeAliases</span>&gt;</span>    <span class="hljs-comment">&lt;!-- 配置环境 --&gt;</span>     <span class="hljs-tag">&lt;<span class="hljs-name">environments</span> <span class="hljs-attr">default</span>=<span class="hljs-string">"mysql"</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">environment</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"mysql"</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">transactionManager</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"JDBC"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">transactionManager</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">dataSource</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"POOLED"</span>&gt;</span>                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"driver"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"com.mysql.jdbc.Driver"</span>/&gt;</span>                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"url"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"jdbc:mysql://localhost:3306/mybatis"</span>/&gt;</span>                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"username"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"root"</span>/&gt;</span>                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"password"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"root"</span>/&gt;</span>            <span class="hljs-tag">&lt;/<span class="hljs-name">dataSource</span>&gt;</span>        <span class="hljs-tag">&lt;/<span class="hljs-name">environment</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">environments</span>&gt;</span>    <span class="hljs-comment">&lt;!-- 配置映射器 --&gt;</span>     <span class="hljs-tag">&lt;<span class="hljs-name">mappers</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">"cn/pine/dao/IUserDao.xml"</span>/&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">mappers</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span></code></pre><p>测试MyBatis</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;        <span class="hljs-comment">//1.读取配置文件</span>        InputStream in = Resources.getResourceAsStream(<span class="hljs-string">"SqlMapConfig.xml"</span>);        <span class="hljs-comment">//2.创建 SqlSessionFactory 的构建者对象</span>        SqlSessionFactoryBuilder builder = <span class="hljs-keyword">new</span> SqlSessionFactoryBuilder();        <span class="hljs-comment">//3.使用构建者创建工厂对象 SqlSessionFactory</span>        SqlSessionFactory factory = builder.build(in);        <span class="hljs-comment">//4.使用 SqlSessionFactory 生产 SqlSession 对象</span>        SqlSession session = factory.openSession();        <span class="hljs-comment">//5.使用 SqlSession 创建 dao 接口的代理对象</span>        IUserDao userDao = session.getMapper(IUserDao.class);        <span class="hljs-comment">//6.使用代理对象执行查询所有方法</span>        List&lt;User&gt; users = userDao.findAll();        <span class="hljs-keyword">for</span>(User user : users) &#123;            System.out.println(user);        &#125;        <span class="hljs-comment">//7.释放资源</span>        session.close();        in.close();    &#125; &#125;</code></pre><p>测试结果</p><p><img src="https://img-blog.csdnimg.cn/20200824112841616.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3BpbmVfZTM=,size_16,color_FFFFFF,t_70" srcset="/img/loading.gif" alt="img"></p><h2 id="基于注解配置的简单示例"><a href="#基于注解配置的简单示例" class="headerlink" title="基于注解配置的简单示例"></a>基于注解配置的简单示例</h2><p>在持久层接口中添加注解</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">IUserDao</span> </span>&#123;    <span class="hljs-meta">@Select</span>(<span class="hljs-string">"select * from user"</span>)    <span class="hljs-function">List&lt;User&gt; <span class="hljs-title">findAll</span><span class="hljs-params">()</span></span>;&#125;</code></pre><p>修改SqlMapConfig.xml，且移除持久层接口的映射xml文件。</p><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">mappers</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"com.itheima.dao.IUserDao"</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">mappers</span>&gt;</span></code></pre>]]></content>
    
    
    <categories>
      
      <category>框架</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>MyBatis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python-day16-20</title>
    <link href="/2020/08/26/pyhthonExample16-20/"/>
    <url>/2020/08/26/pyhthonExample16-20/</url>
    
    <content type="html"><![CDATA[<p><a href="https://github.com/jackfrued/Python-100-Days" target="_blank" rel="noopener">https://github.com/jackfrued/Python-100-Days</a> Day-16-20手敲一遍。</p><a id="more"></a><h1 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h1><ul><li><h2 id="简单选择排序"><a href="#简单选择排序" class="headerlink" title="简单选择排序"></a>简单选择排序</h2><p> <strong>从列表第i元素开始算起，遍历之后的元素，把最小值与当前i元素进行交换。</strong></p><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">select_sort</span><span class="hljs-params">(origin_items, comp=lambda x, y: x&lt; y)</span>:</span>items = origin_items    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(items)):        min_index = i        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> range(i + <span class="hljs-number">1</span>, len(itmes)):            <span class="hljs-keyword">if</span> comp(items[j], items[min_index]):            min_index = j    items[i], items[min_index] = items[min_index], items[i]    <span class="hljs-keyword">return</span> items</code></pre></li><li><h2 id="冒泡排序"><a href="#冒泡排序" class="headerlink" title="冒泡排序"></a>冒泡排序</h2><p> <strong>两两比较，先把最大值放在最后。有发生元素交换就往反方向比较，把最小值放在前面。</strong></p><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">bubble_sort</span><span class="hljs-params">(origin_items, *, comp=lambda x, y: x &gt; y)</span>:</span>    items = origin_items    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">1</span>, len(items)):        swapped = <span class="hljs-literal">False</span>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> range(i - <span class="hljs-number">1</span>, len(items) - i):            <span class="hljs-keyword">if</span> comp(items[j], items[j + <span class="hljs-number">1</span>]):                items[j], items[j + <span class="hljs-number">1</span>] = items[j + <span class="hljs-number">1</span>], items[j]                swapped = <span class="hljs-literal">True</span>        <span class="hljs-keyword">if</span> swapped:            swapped = <span class="hljs-literal">False</span>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> range(len(items) - i - <span class="hljs-number">1</span>, i - <span class="hljs-number">1</span>, <span class="hljs-number">-1</span>):                <span class="hljs-keyword">if</span> comp(items[j - <span class="hljs-number">1</span>], items[j]):                    items[j], items[j - <span class="hljs-number">1</span>] = items[j - <span class="hljs-number">1</span>], items[j]                    swapped = <span class="hljs-literal">True</span>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> swapped:            <span class="hljs-keyword">break</span><span class="hljs-keyword">return</span> items</code></pre></li><li><h2 id="归并排序"><a href="#归并排序" class="headerlink" title="归并排序"></a>归并排序</h2><p> <strong>把列表一直拆分为两个部分，然后两两合并为有序列表。</strong></p><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">merge_sort</span><span class="hljs-params">(items, comp=lambda x, y: x &amp;lt;= y)</span>:</span>    &amp;quot;&amp;quot;&amp;quot;归并排序&amp;quot;&amp;quot;&amp;quot;    <span class="hljs-keyword">if</span> len(items) &amp;lt; <span class="hljs-number">2</span>:        <span class="hljs-keyword">return</span> items[:]    mid = len(items) // <span class="hljs-number">2</span>    left = merge_sort(items[:mid], comp)    right = merge_sort(items[mid:], comp)    <span class="hljs-keyword">return</span> merge(left, right, comp)    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">merge</span><span class="hljs-params">(items1, items2, comp=lambda x, y: x &amp;lt;= y)</span>:</span>    &amp;quot;&amp;quot;&amp;quot;合并（将两个有序列表合并成一个新的有序列表）&amp;quot;&amp;quot;&amp;quot;    items = []    index1, index2 = <span class="hljs-number">0</span>, <span class="hljs-number">0</span>    <span class="hljs-keyword">while</span> index1 &amp;lt; len(items1) <span class="hljs-keyword">and</span> index2 &amp;lt; len(items2):        <span class="hljs-keyword">if</span> comp(items1[index1], items2[index2]):            items.append(items1[index1])            index1 += <span class="hljs-number">1</span>        <span class="hljs-keyword">else</span>:            items.append(items2[index2])            index2 += <span class="hljs-number">1</span>    items += items1[index1:]    items += items2[index2:]    <span class="hljs-keyword">return</span> items</code></pre></li><li><h2 id="快速排序"><a href="#快速排序" class="headerlink" title="快速排序"></a>快速排序</h2><p><strong>选择基准值，将基准值前后元素进行排序。</strong></p><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">quick_sort</span><span class="hljs-params">(origin_items, comp=lambda x, y: x &lt;= y)</span>:</span>    <span class="hljs-string">"""快速排序"""</span>    items = origin_items[:]    _quick_sort(items, <span class="hljs-number">0</span>, len(items) - <span class="hljs-number">1</span>, comp)    <span class="hljs-keyword">return</span> items<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_quick_sort</span><span class="hljs-params">(items, start, end, comp)</span>:</span>    <span class="hljs-string">"""递归调用划分和排序"""</span>    <span class="hljs-keyword">if</span> start &lt; end:        pos = _partition(items, start, end, comp)        _quick_sort(items, start, pos - <span class="hljs-number">1</span>, comp)        _quick_sort(items, pos + <span class="hljs-number">1</span>, end, comp)<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_partition</span><span class="hljs-params">(items, start, end, comp)</span>:</span>    <span class="hljs-string">"""划分(每次划分以最后一个值为基准值，把小于它的值放到前面去，最后把基准值放到中间)"""</span>    pivot = items[end]    i = start - <span class="hljs-number">1</span>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> range(start, end):        <span class="hljs-keyword">if</span> comp(items[j], pivot):            i += <span class="hljs-number">1</span>            items[i], items[j] = items[j], items[i]    items[i + <span class="hljs-number">1</span>], items[end] = items[end], items[i + <span class="hljs-number">1</span>]    <span class="hljs-keyword">return</span> i + <span class="hljs-number">1</span></code></pre></li></ul><h1 id="斐波那契函数"><a href="#斐波那契函数" class="headerlink" title="斐波那契函数"></a>斐波那契函数</h1><ul><li><p><strong>普通形式</strong></p><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">fib</span><span class="hljs-params">(num)</span>:</span>a, b = <span class="hljs-number">1</span>, <span class="hljs-number">1</span><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> range(num - <span class="hljs-number">1</span>):a, b = b, a + b<span class="hljs-keyword">return</span> a</code></pre></li><li><p><strong>生成器形式</strong></p><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">fib3</span><span class="hljs-params">(num)</span>:</span>    a, b = <span class="hljs-number">0</span>, <span class="hljs-number">1</span>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> range(num):        a, b = b, a + b        <span class="hljs-keyword">yield</span> a<span class="hljs-comment">#打印生成器生成值</span><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> fib(<span class="hljs-number">10</span>):print(x)</code></pre></li><li><p><strong>动态规划</strong></p><p><strong>（建立字典保存可能进行重复运算的中间结果（空间换时间））</strong></p><pre><code class="hljs python"><span class="hljs-keyword">from</span> contextlib <span class="hljs-keyword">import</span> contextmanager<span class="hljs-keyword">from</span> time <span class="hljs-keyword">import</span> perf_counter<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">fib</span><span class="hljs-params">(num, results=&#123;&#125;)</span>:</span><span class="hljs-comment">#assert遇到条件不满足时直接返回错误</span>    <span class="hljs-keyword">assert</span> num &gt; <span class="hljs-number">0</span>    <span class="hljs-keyword">if</span> num <span class="hljs-keyword">in</span> (<span class="hljs-number">1</span>, <span class="hljs-number">2</span>):        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>    <span class="hljs-keyword">try</span>:        <span class="hljs-keyword">return</span> results[num]    <span class="hljs-keyword">except</span> KeyError:        results[num] = fib(num - <span class="hljs-number">1</span>) + fib(num - <span class="hljs-number">2</span>)        <span class="hljs-keyword">return</span> results[num]<span class="hljs-comment">#这里通过with timer()的执行逻辑为先记录起始时，执行了fib函数后执行timer的finally代码</span><span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> range(<span class="hljs-number">1</span>, <span class="hljs-number">121</span>):<span class="hljs-keyword">with</span> timer():    print(<span class="hljs-string">f'<span class="hljs-subst">&#123;num&#125;</span>: <span class="hljs-subst">&#123;fib(num)&#125;</span>'</span>)  <span class="hljs-meta">@contextmanager</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">timer</span><span class="hljs-params">()</span>:</span>    <span class="hljs-keyword">try</span>:        start = perf_counter()        <span class="hljs-keyword">yield</span>    <span class="hljs-keyword">finally</span>:        end = perf_counter()        print(<span class="hljs-string">f'<span class="hljs-subst">&#123;end - start&#125;</span>秒'</span>)</code></pre></li></ul><h1 id="贪婪法"><a href="#贪婪法" class="headerlink" title="贪婪法"></a>贪婪法</h1><pre><code class="hljs python"><span class="hljs-string">"""贪婪法：在对问题求解时，总是做出在当前看来是最好的选择，不追求最优解，快速找到满意解。"""</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Thing</span><span class="hljs-params">(object)</span>:</span>    <span class="hljs-string">"""物品"""</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, name, price, weight)</span>:</span>        self.name = name        self.price = price        self.weight = weight<span class="hljs-meta">    @property</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">value</span><span class="hljs-params">(self)</span>:</span>        <span class="hljs-string">"""价格重量比"""</span>        <span class="hljs-keyword">return</span> self.price / self.weight<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">input_thing</span><span class="hljs-params">()</span>:</span>    <span class="hljs-string">"""输入物品信息"""</span>    <span class="hljs-comment">#split()把输入值用空格分割开来</span>    name_str, price_str, weight_str = input().split()    <span class="hljs-keyword">return</span> name_str, int(price_str), int(weight_str)<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>:</span>    <span class="hljs-string">"""主函数"""</span>    <span class="hljs-comment">#map函数表示把输入序列值都int()处理</span>    max_weight, num_of_things = map(int, input().split())    all_things = []    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> range(num_of_things):    <span class="hljs-comment">#*input_thing()作可变参数，为一组列表值</span>        all_things.append(Thing(*input_thing()))    all_things.sort(key=<span class="hljs-keyword">lambda</span> x: x.value, reverse=<span class="hljs-literal">True</span>)    total_weight = <span class="hljs-number">0</span>    total_price = <span class="hljs-number">0</span>    <span class="hljs-keyword">for</span> thing <span class="hljs-keyword">in</span> all_things:        <span class="hljs-keyword">if</span> total_weight + thing.weight &lt;= max_weight:            print(<span class="hljs-string">f'小偷拿走了<span class="hljs-subst">&#123;thing.name&#125;</span>'</span>)            total_weight += thing.weight            total_price += thing.price    print(<span class="hljs-string">f'总价值: <span class="hljs-subst">&#123;total_price&#125;</span>美元'</span>)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:    main()</code></pre><h1 id="递归回溯"><a href="#递归回溯" class="headerlink" title="递归回溯"></a>递归回溯</h1><pre><code class="hljs python"><span class="hljs-string">"""递归回溯法：叫称为试探法，按选优条件向前搜索，当搜索到某一步，发现原先选择并不优或达不到目标时，就退回一步重新选择。经典问题：骑士巡逻"""</span>SIZE = <span class="hljs-number">5</span>total = <span class="hljs-number">0</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">print_board</span><span class="hljs-params">(board)</span>:</span>    <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> board:        <span class="hljs-keyword">for</span> col <span class="hljs-keyword">in</span> row:        <span class="hljs-comment">#打印棋盘，center(4)将字符串居中填充空格至长度为</span>            print(str(col).center(<span class="hljs-number">4</span>), end=<span class="hljs-string">''</span>)        print()<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">patrol</span><span class="hljs-params">(board, row, col, step=<span class="hljs-number">1</span>)</span>:</span><span class="hljs-comment">#判定条件：行列值在棋盘范围内，所走的格子是0</span>    <span class="hljs-keyword">if</span> row &gt;= <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> row &lt; SIZE <span class="hljs-keyword">and</span> \        col &gt;= <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> col &lt; SIZE <span class="hljs-keyword">and</span> \        board[row][col] == <span class="hljs-number">0</span>:        board[row][col] = step        <span class="hljs-keyword">if</span> step == SIZE * SIZE:            <span class="hljs-keyword">global</span> total            total += <span class="hljs-number">1</span>            print(<span class="hljs-string">f'第<span class="hljs-subst">&#123;total&#125;</span>种走法: '</span>)            print_board(board)        patrol(board, row - <span class="hljs-number">2</span>, col - <span class="hljs-number">1</span>, step + <span class="hljs-number">1</span>)        patrol(board, row - <span class="hljs-number">1</span>, col - <span class="hljs-number">2</span>, step + <span class="hljs-number">1</span>)        patrol(board, row + <span class="hljs-number">1</span>, col - <span class="hljs-number">2</span>, step + <span class="hljs-number">1</span>)        patrol(board, row + <span class="hljs-number">2</span>, col - <span class="hljs-number">1</span>, step + <span class="hljs-number">1</span>)        patrol(board, row + <span class="hljs-number">2</span>, col + <span class="hljs-number">1</span>, step + <span class="hljs-number">1</span>)        patrol(board, row + <span class="hljs-number">1</span>, col + <span class="hljs-number">2</span>, step + <span class="hljs-number">1</span>)        patrol(board, row - <span class="hljs-number">1</span>, col + <span class="hljs-number">2</span>, step + <span class="hljs-number">1</span>)        patrol(board, row - <span class="hljs-number">2</span>, col + <span class="hljs-number">1</span>, step + <span class="hljs-number">1</span>)        <span class="hljs-comment">#将走过的格子清零，理解为抹除走过的痕迹</span>        board[row][col] = <span class="hljs-number">0</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>:</span>    board = [[<span class="hljs-number">0</span>] * SIZE <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> range(SIZE)]    patrol(board, SIZE - <span class="hljs-number">1</span>, SIZE - <span class="hljs-number">1</span>)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:    main()</code></pre><h1 id="装饰器"><a href="#装饰器" class="headerlink" title="装饰器"></a>装饰器</h1><pre><code class="hljs python"><span class="hljs-string">"""装饰类的装饰器 - 单例模式 - 一个类只能创建出唯一的对象上下文语法：__enter__ / __exit__"""</span><span class="hljs-keyword">import</span> threading<span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> wraps<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">singleton</span><span class="hljs-params">(cls)</span>:</span>    <span class="hljs-string">"""单例装饰器"""</span>    instances = &#123;&#125;    lock = threading.Lock()<span class="hljs-meta">    @wraps(cls)</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">wrapper</span><span class="hljs-params">(*args, **kwargs)</span>:</span>        <span class="hljs-keyword">if</span> cls <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> instances:            <span class="hljs-keyword">with</span> lock:                <span class="hljs-keyword">if</span> cls <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> instances:                    instances[cls] = cls(*args, **kwargs)        <span class="hljs-keyword">return</span> instances[cls]    <span class="hljs-keyword">return</span> wrapper<span class="hljs-meta">@singleton</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">President</span><span class="hljs-params">()</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, name, country)</span>:</span>        self.name = name        self.country = country    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__str__</span><span class="hljs-params">(self)</span>:</span>        <span class="hljs-keyword">return</span> <span class="hljs-string">f'<span class="hljs-subst">&#123;self.country&#125;</span>: <span class="hljs-subst">&#123;self.name&#125;</span>'</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>:</span>    print(President.__name__)    p1 = President(<span class="hljs-string">'特朗普'</span>, <span class="hljs-string">'美国'</span>)    p2 = President(<span class="hljs-string">'奥巴马'</span>, <span class="hljs-string">'美国'</span>)    print(p1 == p2)    print(p1)    print(p2)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:    main()</code></pre><h1 id="抽象类"><a href="#抽象类" class="headerlink" title="抽象类"></a>抽象类</h1><pre><code class="hljs python"><span class="hljs-keyword">from</span> abc <span class="hljs-keyword">import</span> ABCMeta, abstractmethod<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Employee</span><span class="hljs-params">(metaclass=ABCMeta)</span>:</span>    <span class="hljs-string">"""员工(抽象类)"""</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, name)</span>:</span>        self.name = name<span class="hljs-meta">    @abstractmethod</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_salary</span><span class="hljs-params">(self)</span>:</span>        <span class="hljs-string">"""结算月薪(抽象方法)"""</span>        <span class="hljs-keyword">pass</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Manager</span><span class="hljs-params">(Employee)</span>:</span>    <span class="hljs-string">"""部门经理"""</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_salary</span><span class="hljs-params">(self)</span>:</span>        <span class="hljs-keyword">return</span> <span class="hljs-number">15000.0</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Programmer</span><span class="hljs-params">(Employee)</span>:</span>    <span class="hljs-string">"""程序员"""</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, name, working_hour=<span class="hljs-number">0</span>)</span>:</span>        self.working_hour = working_hour        super().__init__(name)    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_salary</span><span class="hljs-params">(self)</span>:</span>        <span class="hljs-keyword">return</span> <span class="hljs-number">200.0</span> * self.working_hour<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Salesman</span><span class="hljs-params">(Employee)</span>:</span>    <span class="hljs-string">"""销售员"""</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, name, sales=<span class="hljs-number">0.0</span>)</span>:</span>        self.sales = sales        super().__init__(name)    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_salary</span><span class="hljs-params">(self)</span>:</span>        <span class="hljs-keyword">return</span> <span class="hljs-number">1800.0</span> + self.sales * <span class="hljs-number">0.05</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EmployeeFactory</span><span class="hljs-params">()</span>:</span>    <span class="hljs-string">"""创建员工的工厂（工厂模式 - 通过工厂实现对象使用者和对象之间的解耦合）"""</span><span class="hljs-meta">    @staticmethod</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">create</span><span class="hljs-params">(emp_type, *args, **kwargs)</span>:</span>        <span class="hljs-string">"""创建员工"""</span>        emp_type = emp_type.upper()        emp = <span class="hljs-literal">None</span>        <span class="hljs-keyword">if</span> emp_type == <span class="hljs-string">'M'</span>:            emp = Manager(*args, **kwargs)        <span class="hljs-keyword">elif</span> emp_type == <span class="hljs-string">'P'</span>:            emp = Programmer(*args, **kwargs)        <span class="hljs-keyword">elif</span> emp_type == <span class="hljs-string">'S'</span>:            emp = Salesman(*args, **kwargs)        <span class="hljs-keyword">return</span> emp<span class="hljs-keyword">from</span> example12 <span class="hljs-keyword">import</span> EmployeeFactory<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>:</span>    <span class="hljs-string">"""主函数"""</span>    emps = [        EmployeeFactory.create(<span class="hljs-string">'M'</span>, <span class="hljs-string">'曹操'</span>),         EmployeeFactory.create(<span class="hljs-string">'P'</span>, <span class="hljs-string">'荀彧'</span>, <span class="hljs-number">120</span>),        EmployeeFactory.create(<span class="hljs-string">'P'</span>, <span class="hljs-string">'郭嘉'</span>, <span class="hljs-number">85</span>),         EmployeeFactory.create(<span class="hljs-string">'S'</span>, <span class="hljs-string">'典韦'</span>, <span class="hljs-number">123000</span>),    ]    <span class="hljs-keyword">for</span> emp <span class="hljs-keyword">in</span> emps:        print(<span class="hljs-string">'%s: %.2f元'</span> % (emp.name, emp.get_salary()))<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:    main()</code></pre><h1 id="枚举"><a href="#枚举" class="headerlink" title="枚举"></a>枚举</h1><pre><code class="hljs python"><span class="hljs-keyword">from</span> enum <span class="hljs-keyword">import</span> Enum, unique<span class="hljs-keyword">import</span> random<span class="hljs-meta">@unique</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Suite</span><span class="hljs-params">(Enum)</span>:</span>    <span class="hljs-string">"""花色（枚举）"""</span>    SPADE, HEART, CLUB, DIAMOND = range(<span class="hljs-number">4</span>)    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__lt__</span><span class="hljs-params">(self, other)</span>:</span>        <span class="hljs-keyword">return</span> self.value &lt; other.value<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Card</span><span class="hljs-params">()</span>:</span>    <span class="hljs-string">"""牌"""</span>        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, suite, face)</span>:</span>        self.suite = suite        self.face = face    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__repr__</span><span class="hljs-params">(self)</span>:</span>        <span class="hljs-keyword">return</span> self.__str__()    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__str__</span><span class="hljs-params">(self)</span>:</span>        suites = (<span class="hljs-string">'♠️'</span>, <span class="hljs-string">'♥️'</span>, <span class="hljs-string">'♣️'</span>, <span class="hljs-string">'♦️'</span>)        faces = (<span class="hljs-string">''</span>, <span class="hljs-string">'A'</span>, <span class="hljs-string">'2'</span>, <span class="hljs-string">'3'</span>, <span class="hljs-string">'4'</span>, <span class="hljs-string">'5'</span>, <span class="hljs-string">'6'</span>,                  <span class="hljs-string">'7'</span>, <span class="hljs-string">'8'</span>, <span class="hljs-string">'9'</span>, <span class="hljs-string">'10'</span>, <span class="hljs-string">'J'</span>, <span class="hljs-string">'Q'</span>, <span class="hljs-string">'K'</span>)        <span class="hljs-keyword">return</span> <span class="hljs-string">f'<span class="hljs-subst">&#123;suites[self.suite.value]&#125;</span> <span class="hljs-subst">&#123;faces[self.face]&#125;</span>'</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Poker</span><span class="hljs-params">()</span>:</span>    <span class="hljs-string">"""扑克"""</span>        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self)</span>:</span>        self.index = <span class="hljs-number">0</span>        self.cards = [Card(suite, face)                      <span class="hljs-keyword">for</span> suite <span class="hljs-keyword">in</span> Suite                      <span class="hljs-keyword">for</span> face <span class="hljs-keyword">in</span> range(<span class="hljs-number">1</span>, <span class="hljs-number">14</span>)]    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">shuffle</span><span class="hljs-params">(self)</span>:</span>        <span class="hljs-string">"""洗牌"""</span>        self.index = <span class="hljs-number">0</span>        random.shuffle(self.cards)    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">deal</span><span class="hljs-params">(self)</span>:</span>        <span class="hljs-string">"""发牌"""</span>        card = self.cards[self.index]        self.index += <span class="hljs-number">1</span>        <span class="hljs-keyword">return</span> card<span class="hljs-meta">    @property</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">has_more</span><span class="hljs-params">(self)</span>:</span>        <span class="hljs-string">"""是否有更多的牌"""</span>        <span class="hljs-keyword">return</span> self.index &lt; len(self.cards)<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Player</span><span class="hljs-params">()</span>:</span>    <span class="hljs-string">"""玩家"""</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, name)</span>:</span>        self.name = name        self.cards = []    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_card</span><span class="hljs-params">(self, card)</span>:</span>        <span class="hljs-string">"""摸牌"""</span>        self.cards.append(card)    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">arrange</span><span class="hljs-params">(self)</span>:</span>        <span class="hljs-string">"""整理手上的牌"""</span>        self.cards.sort(key=<span class="hljs-keyword">lambda</span> card: (card.suite, card.face))<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>:</span>    <span class="hljs-string">"""主函数"""</span>    poker = Poker()    poker.shuffle()    players = [        Player(<span class="hljs-string">'东邪'</span>), Player(<span class="hljs-string">'西毒'</span>),         Player(<span class="hljs-string">'南帝'</span>), Player(<span class="hljs-string">'北丐'</span>)    ]    <span class="hljs-keyword">while</span> poker.has_more:        <span class="hljs-keyword">for</span> player <span class="hljs-keyword">in</span> players:            player.get_card(poker.deal())    <span class="hljs-keyword">for</span> player <span class="hljs-keyword">in</span> players:        player.arrange()        print(player.name, end=<span class="hljs-string">': '</span>)        print(player.cards)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:    main()</code></pre><h1 id="迭代器"><a href="#迭代器" class="headerlink" title="迭代器"></a>迭代器</h1><p><strong>生成可迭代序列的工具模块</strong></p><pre><code class="hljs python"><span class="hljs-string">"""迭代器 - __iter__ / __next__itertools - 生成可迭代序列的工具模块"""</span><span class="hljs-keyword">import</span> itertools<span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> sqrt<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_prime</span><span class="hljs-params">(num)</span>:</span>    <span class="hljs-string">"""判断素数"""</span>    <span class="hljs-keyword">for</span> factor <span class="hljs-keyword">in</span> range(<span class="hljs-number">2</span>, int(sqrt(num)) + <span class="hljs-number">1</span>):        <span class="hljs-keyword">if</span> num % factor == <span class="hljs-number">0</span>:            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PrimeIter</span><span class="hljs-params">(object)</span>:</span>    <span class="hljs-string">"""素数迭代器"""</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, min_value, max_value)</span>:</span>        <span class="hljs-keyword">assert</span> <span class="hljs-number">2</span> &lt;= min_value &lt;= max_value        self.min_value = min_value - <span class="hljs-number">1</span>        self.max_value = max_value    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__iter__</span><span class="hljs-params">(self)</span>:</span>        <span class="hljs-keyword">return</span> self    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__next__</span><span class="hljs-params">(self)</span>:</span>        self.min_value += <span class="hljs-number">1</span>        <span class="hljs-keyword">while</span> self.min_value &lt;= self.max_value:            <span class="hljs-keyword">if</span> is_prime(self.min_value):                <span class="hljs-keyword">return</span> self.min_value            self.min_value += <span class="hljs-number">1</span>        <span class="hljs-keyword">raise</span> StopIteration()<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FibIter</span><span class="hljs-params">(object)</span>:</span>    <span class="hljs-string">"""斐波那契数迭代器"""</span>        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, num)</span>:</span>        self.num = num        self.a, self.b = <span class="hljs-number">0</span>, <span class="hljs-number">1</span>        self.idx = <span class="hljs-number">0</span>       <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__iter__</span><span class="hljs-params">(self)</span>:</span>        <span class="hljs-keyword">return</span> self    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__next__</span><span class="hljs-params">(self)</span>:</span>        <span class="hljs-keyword">if</span> self.idx &lt; self.num:            self.a, self.b = self.b, self.a + self.b            self.idx += <span class="hljs-number">1</span>            <span class="hljs-keyword">return</span> self.a        <span class="hljs-keyword">raise</span> StopIteration()<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>:</span>    <span class="hljs-comment"># 输出ABCD的全排列</span><span class="hljs-keyword">for</span> val <span class="hljs-keyword">in</span> itertools.permutations(<span class="hljs-string">'ABCD'</span>):print(val)    <span class="hljs-comment"># 从ABCDE中选3个组合</span>    <span class="hljs-keyword">for</span> val <span class="hljs-keyword">in</span> itertools.combinations(<span class="hljs-string">'ABCDE'</span>, <span class="hljs-number">3</span>):        print(val)    <span class="hljs-comment"># 分别从黑红梅方和1-13中形成对应组组合</span>    <span class="hljs-keyword">for</span> val <span class="hljs-keyword">in</span> itertools.product(<span class="hljs-string">'黑红梅方'</span>, range(<span class="hljs-number">1</span>, <span class="hljs-number">14</span>)):        print(val)    <span class="hljs-comment"># 逐一打印生成斐波那契数数列</span>    fib_iter = FibIter(<span class="hljs-number">20</span>)    print(<span class="hljs-string">'===&gt;'</span>, next(fib_iter))    print(<span class="hljs-string">'===&gt;'</span>, next(fib_iter))    <span class="hljs-keyword">for</span> val <span class="hljs-keyword">in</span> fib_iter:         print(val)    <span class="hljs-comment"># 输出2-100000之间的素数</span>    prime_iter = PrimeIter(<span class="hljs-number">2</span>, <span class="hljs-number">100000</span>)    <span class="hljs-keyword">for</span> val <span class="hljs-keyword">in</span> prime_iter:        print(val)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:    main()</code></pre><h1 id="元"><a href="#元" class="headerlink" title="元"></a>元</h1><pre><code class="hljs python"><span class="hljs-string">"""元 - meta元数据 - 描述数据的数据 - metadata元类 - 描述类的类 - metaclass - 继承自type"""</span><span class="hljs-keyword">import</span> threading<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SingletonMeta</span><span class="hljs-params">(type)</span>:</span>    <span class="hljs-string">"""自定义元类"""</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(cls, *args, **kwargs)</span>:</span>        cls.__instance = <span class="hljs-literal">None</span>        cls.lock = threading.Lock()        super().__init__(*args, **kwargs)    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__call__</span><span class="hljs-params">(cls, *args, **kwargs)</span>:</span>        <span class="hljs-keyword">if</span> cls.__instance <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:            <span class="hljs-keyword">with</span> cls.lock:                <span class="hljs-keyword">if</span> cls.__instance <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:                    cls.__instance = super().__call__(*args, **kwargs)        <span class="hljs-keyword">return</span> cls.__instance<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">President</span><span class="hljs-params">(metaclass=SingletonMeta)</span>:</span>    <span class="hljs-string">"""总统(单例类)"""</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, name, country)</span>:</span>        self.name = name        self.country = country    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__str__</span><span class="hljs-params">(self)</span>:</span>        <span class="hljs-keyword">return</span> <span class="hljs-string">f'<span class="hljs-subst">&#123;self.country&#125;</span>: <span class="hljs-subst">&#123;self.name&#125;</span>'</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>:</span>    <span class="hljs-string">"""主函数"""</span>    p1 = President(<span class="hljs-string">'特朗普'</span>, <span class="hljs-string">'美国'</span>)     p2 = President(<span class="hljs-string">'奥巴马'</span>, <span class="hljs-string">'美国'</span>)    p3 = President.__call__(<span class="hljs-string">'克林顿'</span>, <span class="hljs-string">'美国'</span>)    print(p1 == p2) <span class="hljs-comment">#True</span>    print(p1 == p3) <span class="hljs-comment">#True</span>    <span class="hljs-comment">#美国: 特朗普</span><span class="hljs-comment">#美国: 特朗普</span><span class="hljs-comment">#美国: 特朗普</span>    print(p1, p2, p3, sep=<span class="hljs-string">'\n'</span>)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:    main()</code></pre><h1 id="多线程"><a href="#多线程" class="headerlink" title="多线程"></a>多线程</h1><pre><code class="hljs python"><span class="hljs-string">"""多个线程竞争一个资源 - 保护临界资源 - 锁（Lock/RLock）多个线程竞争多个资源（线程数&gt;资源数） - 信号量（Semaphore）多个线程的调度 - 暂停线程执行/唤醒等待中的线程 - Condition"""</span><span class="hljs-keyword">from</span> concurrent.futures <span class="hljs-keyword">import</span> ThreadPoolExecutor<span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint<span class="hljs-keyword">from</span> time <span class="hljs-keyword">import</span> sleep<span class="hljs-keyword">import</span> threading<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Account</span><span class="hljs-params">()</span>:</span>    <span class="hljs-string">"""银行账户"""</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, balance=<span class="hljs-number">0</span>)</span>:</span>        self.balance = balance        lock = threading.Lock()        self.condition = threading.Condition(lock)    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">withdraw</span><span class="hljs-params">(self, money)</span>:</span>        <span class="hljs-string">"""取钱"""</span>        <span class="hljs-keyword">with</span> self.condition:            <span class="hljs-comment"># 余额要够才能取钱</span>            <span class="hljs-keyword">while</span> money &gt; self.balance:                self.condition.wait()            new_balance = self.balance - money            sleep(<span class="hljs-number">0.001</span>)            self.balance = new_balance    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">deposit</span><span class="hljs-params">(self, money)</span>:</span>        <span class="hljs-string">"""存钱"""</span>        <span class="hljs-keyword">with</span> self.condition:            new_balance = self.balance + money            sleep(<span class="hljs-number">0.001</span>)            self.balance = new_balance            self.condition.notify_all()<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">add_money</span><span class="hljs-params">(account)</span>:</span>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:        money = randint(<span class="hljs-number">5</span>, <span class="hljs-number">10</span>)        account.deposit(money)        print(threading.current_thread().name,              <span class="hljs-string">':'</span>, money, <span class="hljs-string">'====&gt;'</span>, account.balance)        sleep(<span class="hljs-number">0.5</span>)<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">sub_money</span><span class="hljs-params">(account)</span>:</span>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:        money = randint(<span class="hljs-number">10</span>, <span class="hljs-number">30</span>)        account.withdraw(money)        print(threading.current_thread().name,              <span class="hljs-string">':'</span>, money, <span class="hljs-string">'&lt;===='</span>, account.balance)        sleep(<span class="hljs-number">1</span>)<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>:</span>    account = Account()    <span class="hljs-comment">#创建线程池</span>    <span class="hljs-keyword">with</span> ThreadPoolExecutor(max_workers=<span class="hljs-number">10</span>) <span class="hljs-keyword">as</span> pool:        <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> range(<span class="hljs-number">5</span>):            pool.submit(add_money, account)            pool.submit(sub_money, account)<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:    main()</code></pre><h1 id="多进程"><a href="#多进程" class="headerlink" title="多进程"></a>多进程</h1><pre><code class="hljs python"><span class="hljs-string">"""多进程和进程池的使用多线程因为GIL的存在不能够发挥CPU的多核特性对于计算密集型任务应该考虑使用多进程time python3 example22.pyreal    0m11.512suser    0m39.319ssys     0m0.169s"""</span><span class="hljs-keyword">import</span> concurrent.futures<span class="hljs-keyword">import</span> mathPRIMES = [    <span class="hljs-number">1116281</span>,    <span class="hljs-number">1297337</span>,    <span class="hljs-number">104395303</span>,    <span class="hljs-number">472882027</span>,    <span class="hljs-number">533000389</span>,    <span class="hljs-number">817504243</span>,    <span class="hljs-number">982451653</span>,    <span class="hljs-number">112272535095293</span>,    <span class="hljs-number">112582705942171</span>,    <span class="hljs-number">112272535095293</span>,    <span class="hljs-number">115280095190773</span>,    <span class="hljs-number">115797848077099</span>,    <span class="hljs-number">1099726899285419</span>] * <span class="hljs-number">5</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_prime</span><span class="hljs-params">(n)</span>:</span>    <span class="hljs-string">"""判断素数"""</span>    <span class="hljs-keyword">if</span> n % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>:        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>    sqrt_n = int(math.floor(math.sqrt(n)))    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">3</span>, sqrt_n + <span class="hljs-number">1</span>, <span class="hljs-number">2</span>):        <span class="hljs-keyword">if</span> n % i == <span class="hljs-number">0</span>:            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>:</span>    <span class="hljs-string">"""主函数"""</span>    <span class="hljs-keyword">with</span> concurrent.futures.ProcessPoolExecutor() <span class="hljs-keyword">as</span> executor:        <span class="hljs-keyword">for</span> number, prime <span class="hljs-keyword">in</span> zip(PRIMES, executor.map(is_prime, PRIMES)):            print(<span class="hljs-string">'%d is prime: %s'</span> % (number, prime))<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:    main()</code></pre><h1 id="协程"><a href="#协程" class="headerlink" title="协程"></a>协程</h1><pre><code class="hljs python"><span class="hljs-string">"""协程（coroutine）- 可以在需要时进行切换的相互协作的子程序"""</span><span class="hljs-keyword">import</span> asyncio<span class="hljs-keyword">from</span> example15 <span class="hljs-keyword">import</span> is_prime<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">num_generator</span><span class="hljs-params">(m, n)</span>:</span>    <span class="hljs-string">"""指定范围的数字生成器"""</span>    <span class="hljs-keyword">yield</span> <span class="hljs-keyword">from</span> range(m, n + <span class="hljs-number">1</span>)<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">prime_filter</span><span class="hljs-params">(m, n)</span>:</span>    <span class="hljs-string">"""素数过滤器"""</span>    primes = []    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> num_generator(m, n):        <span class="hljs-keyword">if</span> is_prime(i):            print(<span class="hljs-string">'Prime =&gt;'</span>, i)            primes.append(i)        <span class="hljs-keyword">await</span> asyncio.sleep(<span class="hljs-number">0.001</span>)    <span class="hljs-keyword">return</span> tuple(primes)<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">square_mapper</span><span class="hljs-params">(m, n)</span>:</span>    <span class="hljs-string">"""平方映射器"""</span>    squares = []    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> num_generator(m, n):        print(<span class="hljs-string">'Square =&gt;'</span>, i * i)        squares.append(i * i)        <span class="hljs-keyword">await</span> asyncio.sleep(<span class="hljs-number">0.001</span>)    <span class="hljs-keyword">return</span> squares<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>:</span>    <span class="hljs-string">"""主函数"""</span>    loop = asyncio.get_event_loop()    future = asyncio.gather(prime_filter(<span class="hljs-number">2</span>, <span class="hljs-number">100</span>), square_mapper(<span class="hljs-number">1</span>, <span class="hljs-number">100</span>))    future.add_done_callback(<span class="hljs-keyword">lambda</span> x: print(x.result()))    loop.run_until_complete(future)    loop.close()<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:   main()</code></pre><h1 id="异步HTTP访问"><a href="#异步HTTP访问" class="headerlink" title="异步HTTP访问"></a>异步HTTP访问</h1><pre><code class="hljs python"><span class="hljs-string">"""aiohttp - 异步HTTP网络访问异步I/O（异步编程）- 只使用一个线程（单线程）来处理用户请求用户请求一旦被接纳，剩下的都是I/O操作，通过多路I/O复用也可以达到并发的效果这种做法与多线程相比可以让CPU利用率更高，因为没有线程切换的开销Redis/Node.js - 单线程 + 异步I/OCelery - 将要执行的耗时间的任务异步化处理异步I/O事件循环 - uvloop"""</span><span class="hljs-keyword">import</span> asyncio<span class="hljs-keyword">import</span> re<span class="hljs-keyword">import</span> aiohttp<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">fetch</span><span class="hljs-params">(session, url)</span>:</span>    <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> session.get(url, ssl=<span class="hljs-literal">False</span>) <span class="hljs-keyword">as</span> resp:        <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> resp.text()<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>:</span>    pattern = re.compile(<span class="hljs-string">r'\&lt;title\&gt;(?P&lt;title&gt;.*)\&lt;\/title\&gt;'</span>)    urls = (<span class="hljs-string">'https://www.python.org/'</span>,            <span class="hljs-string">'https://git-scm.com/'</span>,            <span class="hljs-string">'https://www.jd.com/'</span>,            <span class="hljs-string">'https://www.taobao.com/'</span>,            <span class="hljs-string">'https://www.douban.com/'</span>)    <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> aiohttp.ClientSession() <span class="hljs-keyword">as</span> session:        <span class="hljs-keyword">for</span> url <span class="hljs-keyword">in</span> urls:            html = <span class="hljs-keyword">await</span> fetch(session, url)            print(pattern.search(html).group(<span class="hljs-string">'title'</span>))<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:    loop = asyncio.get_event_loop()    loop.run_until_complete(main())    loop.close()</code></pre>]]></content>
    
    
    <categories>
      
      <category>Python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>语言学习</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>mysql命令</title>
    <link href="/2019/07/13/mysql/"/>
    <url>/2019/07/13/mysql/</url>
    
    <content type="html"><![CDATA[<p>这次记录理解学习mysql命令</p><a id="more"></a><pre><code class="hljs undefined">create database xx;<span class="hljs-comment">//创建数据库xx</span>show databases;查看数据库drop database xx;删除数据库use xx;<span class="hljs-comment">//进入xx数据库</span><span class="hljs-function">create table <span class="hljs-title">xxx</span> (<span class="hljs-params">id <span class="hljs-keyword">int</span> (<span class="hljs-number">32</span></span>),username <span class="hljs-title">varchar</span>(<span class="hljs-params"><span class="hljs-number">40</span></span>),password <span class="hljs-title">varchar</span>(<span class="hljs-params"><span class="hljs-number">32</span></span>))</span>;创建表格式show create tables;查看表desc xxx;<span class="hljs-comment">// 查看表结构</span><span class="hljs-function"><span class="hljs-keyword">select</span> <span class="hljs-title">database</span>(<span class="hljs-params"></span>)</span>;<span class="hljs-comment">//查看当前表在哪个库下 </span>drop xxx;<span class="hljs-comment">//删除xxx表</span>alter table 原表命 rename 新表明alter table xx change 字段名 字段名<span class="hljs-number">1</span> varchar(<span class="hljs-number">66</span>);<span class="hljs-comment">//修改字段</span>alter table xx modify 字段名 修改值;<span class="hljs-comment">//修改字段值</span>alter table xx drop 字段名;<span class="hljs-comment">//删除字段</span>alter table xx <span class="hljs-keyword">add</span> 字段名 varchar(<span class="hljs-number">55</span>) first;<span class="hljs-comment">//插入字段到首行</span>alter table xx <span class="hljs-keyword">add</span> 字段名 varchar(<span class="hljs-number">55</span>) after 字段名<span class="hljs-number">1</span>;<span class="hljs-comment">//插入到字段名1后一行</span>show index <span class="hljs-keyword">from</span> xx;<span class="hljs-comment">//查看索引情况</span><span class="hljs-function">alter table xx <span class="hljs-keyword">add</span> <span class="hljs-title">index</span>(<span class="hljs-params">字段</span>)</span>;<span class="hljs-comment">//给字段加入普通索引 </span><span class="hljs-function">alter table xx <span class="hljs-keyword">add</span> <span class="hljs-title">unique</span>(<span class="hljs-params">字段</span>)</span>;<span class="hljs-comment">//给字段加入唯一索引 </span><span class="hljs-function">alter table xx <span class="hljs-keyword">add</span> <span class="hljs-title">fulltext</span>(<span class="hljs-params">字段</span>)</span>;<span class="hljs-comment">//给字段加入全文索引 </span><span class="hljs-function">alter table xx <span class="hljs-keyword">add</span> primary <span class="hljs-title">key</span>(<span class="hljs-params">字段</span>)</span>;<span class="hljs-comment">//给字段加入主键索引 </span><span class="hljs-function">insert <span class="hljs-keyword">into</span> bbs_user <span class="hljs-title">values</span>(<span class="hljs-params"><span class="hljs-number">1</span>,<span class="hljs-string">'成龙'</span>,<span class="hljs-number">123123</span>,<span class="hljs-number">64</span>,<span class="hljs-number">223</span>,<span class="hljs-number">333324</span></span>)</span>;<span class="hljs-comment">//给bbs_user表下插入数据</span><span class="hljs-function">insert <span class="hljs-keyword">into</span> <span class="hljs-title">bbs_user</span>(<span class="hljs-params">id , username , password , age , email , address </span>) <span class="hljs-title">values</span>(<span class="hljs-params"><span class="hljs-number">2</span>,<span class="hljs-string">'萨拉赫'</span>,<span class="hljs-number">123445</span>,<span class="hljs-number">12</span>,<span class="hljs-number">1231</span>,<span class="hljs-number">123123</span></span>),(<span class="hljs-params"><span class="hljs-string">'库蒂尼奥'</span> ，<span class="hljs-number">1231</span>，<span class="hljs-number">13</span>，<span class="hljs-number">1312</span>，<span class="hljs-number">132123</span></span>)</span>;<span class="hljs-comment">//与上一条命令不同在于自动递增的id字段不用输入直接从username开始就行，也可插入多条数据，更灵活</span><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> bbs_user;<span class="hljs-comment">//查看bbs_user表下的数据</span><span class="hljs-function"><span class="hljs-keyword">select</span> <span class="hljs-title">count</span> (<span class="hljs-params">*</span>) <span class="hljs-keyword">from</span> bbs_user</span>;<span class="hljs-comment">//查看bbs_user表下的数据个数</span><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> bbs_user <span class="hljs-keyword">where</span> id=<span class="hljs-number">2</span>;<span class="hljs-comment">//查看bbs_user表下id=2的数据</span><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> bbs_user <span class="hljs-keyword">where</span> id&gt;<span class="hljs-number">2</span>;<span class="hljs-comment">//查看bbs_user表下id&gt;2的数据</span><span class="hljs-keyword">select</span> username, address <span class="hljs-keyword">from</span> bbs_user;<span class="hljs-comment">//查看bbs_user表下username, address的数据</span><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> bbs_user <span class="hljs-keyword">where</span> id <span class="hljs-keyword">in</span>&lt;<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,&gt;;<span class="hljs-comment">//查看bbs_user表下id为1，3，4，的数据</span><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> bbs_user <span class="hljs-keyword">where</span> username like <span class="hljs-string">'四%'</span>;<span class="hljs-comment">//模糊查询，查bbs_user表username开头为四的数据</span><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> bbs_user <span class="hljs-keyword">where</span> username like <span class="hljs-string">'%四'</span>%;<span class="hljs-comment">//模糊查询，查bbs_user表username有四的数据</span><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> bbs_user order <span class="hljs-keyword">by</span> address;<span class="hljs-comment">//使bbs_user表根据address字段升排序 </span><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> bbs_user order <span class="hljs-keyword">by</span> address desc;<span class="hljs-comment">//使bbs_user表根据address字段降排序 </span><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> bbs_user <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> password;<span class="hljs-comment">//将表按照password字段分组，（字段相同不显示）</span><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> bbs_user limit <span class="hljs-number">5</span>,<span class="hljs-number">15</span>;<span class="hljs-comment">//检索记录行6到行15</span><span class="hljs-keyword">select</span> username , gname <span class="hljs-keyword">from</span> shop_user inner <span class="hljs-keyword">join</span> shop_goods <span class="hljs-keyword">on</span> shop_user.gid = shop_goods.gid;<span class="hljs-comment">//内联查询 ，查询两个表对应的数据（一二，二三，看一三）</span><span class="hljs-keyword">select</span> shop_user.username  <span class="hljs-keyword">from</span> shop_user left <span class="hljs-keyword">join</span> shop_goods <span class="hljs-keyword">on</span> shop_user.gid = shop_goods.gid;<span class="hljs-comment">//左联查询，以左表为基准</span><span class="hljs-keyword">select</span> shop_user.username <span class="hljs-keyword">from</span> shop_user right <span class="hljs-keyword">join</span> shop_goods <span class="hljs-keyword">on</span> shop_user.gid = shop_goods.gid;<span class="hljs-comment">//右联查询，以右表为基准</span><span class="hljs-keyword">select</span> *<span class="hljs-function"><span class="hljs-keyword">from</span> shop_user <span class="hljs-keyword">where</span> gid <span class="hljs-title">in</span>(<span class="hljs-params"><span class="hljs-keyword">select</span> gid <span class="hljs-keyword">from</span> shop_goods</span>)</span>;<span class="hljs-comment">//查shop_user下有带shop_goods中gid中的值的所有数据</span>delete <span class="hljs-keyword">from</span> bbs_user <span class="hljs-keyword">where</span> username=<span class="hljs-string">'李敖'</span>;<span class="hljs-comment">//删除表中数据</span>update bbs_user <span class="hljs-keyword">set</span> username=<span class="hljs-string">'安安'</span>,address=<span class="hljs-string">'88888'</span> <span class="hljs-keyword">where</span> id=<span class="hljs-number">1</span>;<span class="hljs-comment">//把id为1的数据的username字段改为安安，address字段改为88888</span></code></pre>]]></content>
    
    
    <categories>
      
      <category>mysql</category>
      
    </categories>
    
    
    <tags>
      
      <tag>命令</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
